<Project>

  <Target Name="GetArtifactInfo" Returns="@(ArtifactInfo)">
    <PropertyGroup>
      <NormalizedPackageVersion>$(PackageVersion)</NormalizedPackageVersion>
      <!-- Strip version metadata -->
      <NormalizedPackageVersion Condition="$(NormalizedPackageVersion.Contains('+'))">$(PackageVersion.Substring(0, $(PackageVersion.IndexOf('+'))))</NormalizedPackageVersion>
    </PropertyGroup>

    <ItemGroup Condition="'$(IsPackable)' == 'true' ">
      <ArtifactInfo Include="$(PackageOutputPath)$(PackageId).$(NormalizedPackageVersion).nupkg">
        <ArtifactType>NuGetPackage</ArtifactType>
        <PackageId>$(PackageId)</PackageId>
        <Version>$(NormalizedPackageVersion)</Version>
        <TargetFramework>$(TargetFramework)</TargetFramework>
        <TargetFrameworks>$([MSBuild]::Escape($(TargetFrameworks)))</TargetFrameworks>
        <PackageType>$(PackageType)</PackageType>
        <RepositoryRoot>$(RepositoryRoot)</RepositoryRoot>
        <Category>$(PackageArtifactCategory)</Category>
      </ArtifactInfo>

      <ArtifactInfo Include="$(PackageOutputPath)$(PackageId).$(NormalizedPackageVersion).symbols.nupkg" Condition="'$(IncludeSymbols)' == 'true' AND '$(NuspecFile)' == ''">
        <ArtifactType>NuGetSymbolsPackage</ArtifactType>
        <PackageId>$(PackageId)</PackageId>
        <Version>$(NormalizedPackageVersion)</Version>
        <TargetFramework>$(TargetFramework)</TargetFramework>
        <TargetFrameworks>$([MSBuild]::Escape($(TargetFrameworks)))</TargetFrameworks>
        <SourceIncluded>$(IncludeSource)</SourceIncluded>
        <PackageType>$(PackageType)</PackageType>
        <RepositoryRoot>$(RepositoryRoot)</RepositoryRoot>
        <Category>$(PackageArtifactCategory)</Category>
      </ArtifactInfo>
    </ItemGroup>
  </Target>

</Project>
